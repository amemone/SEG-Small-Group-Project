<div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav ms-auto mb-2 mb-lg-0">

        <!-- Dashboard -->
        <li class="nav-item me-3">
            <a class="nav-link {% if request.path == '/dashboard/' %}fw-bold{% endif %}" 
               href="{% url 'dashboard' %}">
                Dashboard
            </a>
        </li>

        <!-- Feed -->
        <li class="nav-item me-3">
            <a class="nav-link {% if request.path == '/feed/' %}fw-bold{% endif %}" 
               href="{% url 'feed' %}">
                Feed
            </a>
        </li>

        <!-- Browse -->
        <li class="nav-item me-3">
            <a class="nav-link {% if request.path == '/recipes/browse/' %}fw-bold{% endif %}" 
               href="{% url 'recipe_browse' %}">
                Browse
            </a>
        </li>

        <!-- Notification Bell -->
        <li class="nav-item dropdown me-3">
            <a class="nav-link position-relative" href="#" id="notifBell" role="button" data-bs-toggle="dropdown">
                <i class="bi bi-bell"></i>
                {% if unread_count %}
                    <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                        {{ unread_count }}
                    </span>
                {% endif %}
            </a>

            <ul class="dropdown-menu dropdown-menu-end shadow notif-dropdown" aria-labelledby="notifBell">
                <!-- Fixed header -->
                <li class="dropdown-header fw-bold">Notifications</li>
                <li><hr class="dropdown-divider"></li>

                <!-- Notifications list -->
                {% for notification in request.user.notifications.all|dictsortreversed:"created_at"|slice:":50" %}
                    <li>
                        <a class="dropdown-item {% if not notification.is_read %}fw-bold{% endif %}"
                          href="{% url 'notification_read' notification.id %}">
                            {{ notification.text }}
                        </a>
                    </li>
                {% empty %}
                    <li><span class="dropdown-item text-muted">No notifications</span></li>
                {% endfor %}
            </ul>
        </li>

        <!-- User Account Dropdown -->
        <li class="nav-item dropdown">
            <a class="nav-link" href="#" id="user-account-dropdown" role="button" data-bs-toggle="dropdown"
               aria-expanded="false">
                <span class="bi-person-circle"></span>
            </a>
            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="user-account-dropdown">
                <li><a class="dropdown-item" href="{% url 'view_profile' %}">View Profile</a></li>
                <li><a class="dropdown-item" href="{% url 'profile' %}">Change Profile</a></li>
                <li><a class="dropdown-item" href="{% url 'password' %}">Change password</a></li>
                <li><a class="dropdown-item" href="{% url 'user_browse' %}">Search user</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="{% url 'log_out' %}">Log out</a></li>
            </ul>
        </li>

    </ul>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const scrollable = document.querySelector('.notif-scrollable');
    if (scrollable) {
        scrollable.addEventListener('wheel', function(e) {
            e.stopPropagation();
        });
    }
});
</script>
